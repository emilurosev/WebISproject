<div class="container">
  
  

  <h3 style="text-align: center; margin-top: 50px; margin-bottom: 100px">Hello {{username}}!</h3>
  <p *ngIf="invalidUsername" style="color:red">Invalid username!</p>
  <button *ngIf="searchAcitve" (click)="back()">Back</button>
  <div class="form-inline" style="margin: auto;">
    <input  class="form-control" type="text" [(ngModel)]="recieversName" placeholder="Enter recievers username">
    <button class="btn btn-outline-primary" (click)='setReciever(recieversName)'>Search</button>
  </div>

  <div style="text-align: center; margin-bottom: 100px">

    <div style="overflow-y:scroll; overflow-x:hidden; height:400px; width: 16%" class="parts">
      <div *ngFor='let username of usernames | orderBy: "displayUnread(i)"; let i=index'>
        <button class="btn btn-outline-success" style="width: 147px;" (click)='setReciever(username);'>
          {{username}}<i *ngIf="!displayUnread(i)>0" class="fa fa-circle" aria-hidden="true" style="font-size: 5px; float: right; margin-top: 11px"></i><span style="color: blue;float: right" *ngIf="displayUnread(i)>0">{{displayUnread(i)}}</span>
        </button>
      </div>
    </div>

    <div style="width: 50%" class="parts">
      
      <div style="overflow-y:scroll; overflow-x:hidden; height:218px">
        <div *ngFor="let el of lista">
          <p *ngIf="el.receiver == 'everyone'">{{el.sender}}: {{el.body}}</p>
        </div> 
      </div>
    
      <div >
        <div class="form-group">
          <textarea placeholder="Enter a message" [(ngModel)]="msg" class="form-control" rows="5" ></textarea>
        </div>  
        <button class="btn btn-outline-primary" type="button" (click)="sendToEveryone()">Send to Everyone</button>
      </div>
  
    </div>

    <div *ngIf="openPrivate" style="width: 34%" class="parts">
    
      <div style="overflow-y:scroll; overflow-x:hidden; height:218px">
        <div *ngFor="let el of lista">
            <p *ngIf="((el.receiver == username && el.sender == receiver) || ( el.sender == username && el.receiver == receiver) && el.receiver != 'everyone') ">{{el.sender}}: {{el.body}}</p>
        </div> 
      </div>
    
      <div >
        <div class="form-group">
          <textarea placeholder="Enter a private message for {{receiver}}" [(ngModel)]="msgForPrivate" class="form-control" rows="5" (click)="resetUnread(receiver)" ></textarea>
        </div>  
        <button class="btn btn-outline-primary" type="button" (click)="send()">Send to {{receiver}}</button>
        <button class="btn btn-outline-danger" type="button" (click)=closePrivate()>Close</button>
      </div>
  
    </div>

  </div>


  

</div>
